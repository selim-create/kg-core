(()=>{"use strict";const e=window.wp.blocks,t=window.React,a=window.wp.element,c=window.wp.components,n=window.wp.i18n;window.wp.apiFetch,(0,e.registerBlockType)("kg-core/embed",{edit:function({attributes:e,setAttributes:l}){const[m,s]=(0,a.useState)(""),[i,r]=(0,a.useState)([]),[o,d]=(0,a.useState)(!1),[g,k]=(0,a.useState)(""),{contentType:p,selectedItems:b}=e;(0,a.useEffect)(()=>{const e=setTimeout(()=>{m.length>0?u():r([])},300);return()=>clearTimeout(e)},[m,p]);const u=async()=>{d(!0),k("");try{const e=new FormData;e.append("action","kg_block_search_content"),e.append("nonce",kgBlockEmbed.nonce),e.append("type",p),e.append("search",m);const t=await fetch(kgBlockEmbed.ajaxUrl,{method:"POST",body:e}),a=await t.json();a.success?r(a.data.items||[]):(k(a.data?.message||(0,n.__)("Search failed","kg-core")),r([]))}catch(e){k((0,n.__)("Search error occurred","kg-core")),r([])}finally{d(!1)}},E=e=>b.some(t=>t.id===e);return(0,t.createElement)("div",{className:"kg-embed-block"},(0,t.createElement)("div",{className:"kg-embed-tabs"},(0,t.createElement)("button",{className:"recipe"===p?"active":"",onClick:()=>{l({contentType:"recipe"}),r([]),s("")}},"ðŸ¥• ",(0,n.__)("Tarifler","kg-core")),(0,t.createElement)("button",{className:"ingredient"===p?"active":"",onClick:()=>{l({contentType:"ingredient"}),r([]),s("")}},"ðŸ¥¬ ",(0,n.__)("Malzemeler","kg-core")),(0,t.createElement)("button",{className:"tool"===p?"active":"",onClick:()=>{l({contentType:"tool"}),r([]),s("")}},"ðŸ”§ ",(0,n.__)("AraÃ§lar","kg-core")),(0,t.createElement)("button",{className:"post"===p?"active":"",onClick:()=>{l({contentType:"post"}),r([]),s("")}},"ðŸ“– ",(0,n.__)("YazÄ±lar","kg-core"))),(0,t.createElement)("div",{className:"kg-embed-search"},(0,t.createElement)(c.TextControl,{placeholder:(0,n.__)("Ä°Ã§erik ara...","kg-core"),value:m,onChange:s})),o&&(0,t.createElement)("div",{className:"kg-embed-loading"},(0,t.createElement)(c.Spinner,null),(0,t.createElement)("span",null,(0,n.__)("YÃ¼kleniyor...","kg-core"))),g&&(0,t.createElement)("div",{className:"kg-embed-error"},g),!o&&i.length>0&&(0,t.createElement)("div",{className:"kg-embed-results"},(0,t.createElement)("h4",null,(0,n.__)("SonuÃ§lar","kg-core")),i.map(e=>(0,t.createElement)("div",{key:e.id,className:"kg-embed-result-item "+(E(e.id)?"selected":""),onClick:()=>(e=>{const t=b.some(t=>t.id===e.id);l(t?{selectedItems:b.filter(t=>t.id!==e.id)}:{selectedItems:[...b,e]})})(e)},e.image&&(0,t.createElement)("img",{src:e.image,alt:e.title}),!e.image&&(0,t.createElement)("div",{className:"kg-embed-no-image"},(0,t.createElement)("span",{className:`dashicons ${e.icon||"dashicons-admin-post"}`})),(0,t.createElement)("div",{className:"kg-embed-item-info"},(0,t.createElement)("div",{className:"kg-embed-item-title"},e.title),e.meta&&(0,t.createElement)("div",{className:"kg-embed-item-meta"},e.meta)),E(e.id)&&(0,t.createElement)("span",{className:"kg-embed-checkmark"},"âœ“")))),!o&&m&&0===i.length&&!g&&(0,t.createElement)("div",{className:"kg-embed-no-results"},(0,n.__)("SonuÃ§ bulunamadÄ±","kg-core")),b.length>0&&(0,t.createElement)("div",{className:"kg-embed-preview"},(0,t.createElement)("h4",null,(0,n.__)("SeÃ§ilen Ä°Ã§erikler","kg-core")," (",b.length,")"),(0,t.createElement)("div",{className:"kg-embed-preview-list"},b.map(e=>(0,t.createElement)("div",{key:e.id,className:"kg-embed-preview-item"},e.image&&(0,t.createElement)("img",{src:e.image,alt:e.title}),!e.image&&(0,t.createElement)("div",{className:"kg-embed-no-image-small"},(0,t.createElement)("span",{className:`dashicons ${e.icon||"dashicons-admin-post"}`})),(0,t.createElement)("div",{className:"kg-embed-preview-info"},(0,t.createElement)("div",{className:"kg-embed-preview-title"},e.title),e.meta&&(0,t.createElement)("div",{className:"kg-embed-preview-meta"},e.meta)),(0,t.createElement)("button",{className:"kg-embed-remove-btn",onClick:()=>{return t=e.id,void l({selectedItems:b.filter(e=>e.id!==t)});var t},"aria-label":(0,n.__)("KaldÄ±r","kg-core")},"Ã—"))))))},save:function({attributes:e}){const{contentType:a,selectedItems:c}=e;if(!c||0===c.length)return null;const n=c.map(e=>e.id).join(",");return(0,t.createElement)("div",{className:"kg-embed-placeholder","data-type":a,"data-ids":n},`[kg-embed type="${a}" ids="${n}"]`)}})})();